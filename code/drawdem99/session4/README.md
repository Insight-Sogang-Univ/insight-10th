# 통계 - 회귀

## 용어 정리

- 지도 학습 : 정답값(label)이 있는 데이터셋으로 학습하는 방식
- 비지도 학습 : 정답값(label)이 없는 데이터셋으로 학습하는 방식

- 회귀(지도학습)
    - 둘 이상의 변수 관계를 보여주는 통계적 기법
    - 지도학습 : 과거의 데이터로 학습
    - 예측 문제 중 출력 변수의 값이 연속적일 때 해당 문제를 회귀분석이라고 칭한다. ex) 집값 예측, 주식 가격 예측
- 분류(지도학습)
    - 범주형 변수에 대해 예측할 때 사용
    - 하나 이상의 관측된 데이터를 통해 하나 이상의 값을 예측. ex) 스팸 문자 여부
- 군집화(Clustering, 비지도학습)
    - 주어진 데이터들의 특성을 고려해 같은 그룹(cluster)을 정의하고 그룹화하여 그룹의 대표성을 찾는 방법
    - 비지도 학습 : 구분하려고 하는 class에 대해 아무런 정보가 없이 학습


## 회귀란?

- 여러 개의 독립 변수와 한 개의 종속변수 간의 관계를 모델링
- 무언가를 "예측"


### 선형회귀(Linear Regression)

- 실제 값과 예측값의 차이를 최소화하는 직선형 회귀선을 최적화하는 방식
- 선형회귀 직선은 x와 y의 관계를 요약해 설명한다.
- 독립변수 x의 개수가 하나라면 단순선형회귀, 2개 이상이면 다중선형회귀라 칭함.


### 선형회귀분석의 목적

1) 데이터 이해 : 독립변수를 이용해 종속변수의 변화를 이해
2) 예측
    - 과거의 데이터를 기반으로 모델을 형성하여 미래의 값을 예측.
    - 회귀(Regression)는 머신러닝 분야 중 Supervised Learning에서 사용하는 모델 중 하나
3) 인과관계 예측
    - 인과관계를 측정하고 추정하는 기능
    - 다른 요인을 통제했을 때, 예상한 효과가 반복되는가를 확인
    

### 단순선형회귀(Simple Linear Regression)

- 연속형 반응 변수 y와 설명변수 x 하나를 갖는 모델
- e : 오차
- β0, β1 : 회귀 계수(Regression coefficient)


### 다중선형회귀(Multiple Linear Regression)

- 연속형 반응(종속) 변수 하나에 설명(독립) 변수가 둘 이상이 모인 모형
- 다중공산성(Multicolinearity) : 다중선형회귀를 사용할 때 주의해야 할 점
    1. 설명 변수들 간의 선형 종속이 심한 경우

- 다중공산성 확인 방법
    1. 산점도 그래프(Scatter plot matrix) 그리기 : 독립변수 간의 pair plot을 찍어보았을 때 일부 변수 간의 플랏이 선형성을 띄는지 여부
    2. 상관계수 확인 : 1에 가까울수록 높은 상관계수를 보임
    3. 분산팽창계수(VIF, Variance Inflation Factor) : VF값이 10 이상일 시 다중공산성 있다고 판단 - VF란 독립변수를 다른 독립변수로 선형회귀한 성능을 나타낸 지표, 다른 변수의 의존도를 나타냄

- 다중공산성 대처 방법
    1. 변수 제거 : 자료의 다양성을 해칠 위험이 존재
    2. 변수 변환 : 변수를 더하거나 빼서 새로운 변수 생성
    3. 규제 선형 모델 활용 : 릿지, 라쏘, 엘라스틱넷 등의 방법으로 모델의 복잡도를 줄임
    4. PCA


## 회귀 분석 과정

1. 산점도 그리기 : 데이터를 2차원의 산점도로 나타내어 선형성을 가지는지 시각화를 통해 확인이 가능하다.
2. 회귀계수 추정
    - 최소제곱법(최소자승법) : 오차를 최소화시키는 방법으로 회귀 계수를 추정
    - 오차향 가정 직접법 : 두 가지 가정을 전제로 회귀 모델의 평균과 공분산을 계산
        1. 오차향의 평균(기댓값)은 0이다
        2. 오차향의 분산은 x에 관계없이 일정하다
3. 유의성 검정 : 모델에서 사용한 독립 변수들이 종속 변수에 대해 유의미한 영향을 미치는지 검정
    - T-test
        - 선형 회귀분석에서 특정 변수가 모델에서 통계적으로 유의미한지 확인
        - T-검정은 모델에서 다양한 변수의 유의성을 비교하는 데에도 사용되며, 종속변수를 예측하는데 가장 중요한 변수를 식별
    - F-test
        - 분산분석(ANOVA : analysis of variance)를 하는 방법
        - MSE/MSR로 F-statistics 계산


### 선형회귀분석의 해석 방법 - SDEM

1. 유의성 검증(Significance)
    - 계산한 x의 계수가 실제로 일반화할 수 있는 수치인가
    - 계수의 p-value가 유의한가
2. 방향성 확인(Direction)
    - 내가 세운 가설대로 계수가 나오는가
    - +라고 가설을 세웠을 때 반대의 경우가 나오는가
3. 효과의 크기(Effect size)
    - 계수 자체의 절대값을 측정하는 것
    - 유의하더라도 그 효과 크기가 작다면 실험 결과를 반영하지 않을 수 있다
4. 모델 적합성(Model-fitting)
    - 통계 모델이 데이터셋을 전체적으로 얼마나 잘 설명했는가
    - Under-fitting / Over-fitting


### 회귀 모형의 평가

- 평균제곱오차(MSE or MSD) : 모델을 통해 추정된 값과 실측값의 차에 대한 제곱합의 평균. 값이 크다면 예측력이 떨어짐을 의미.
- 결정계수 : 독립변수가 종속변수를 얼마나 잘 설명해주는지 가리키는 지표


### 회귀분석의 기본 가정 진단 : 회귀 모형이 적절한가

- 선형성 진단
    - 반응 변수와 설명 변수가 선형 관계인가
    - Scatter plot을 통해 서로 선형 관계인지 확인
- 오차항의 독립성 진단
    - 시각적인 독립성을 판단하는 방법으로 오차 앞뒤간의 관계를 파악하기 위해 산점도를 그려보기
    - 수치적으로 독립성 파악
    - Durbin-Watson 검정
    - 잔차 데이터 간의 상관관계 유무
- 오차항의 등분산성 진단
    - n개의 오차항이 모두 같은 분산을 갖는 분포로부터 추출되었는지 여부
    - 특정 설명변수 구간에서 뚜렷하게 크거나 작으면 등분산 가정에 타당하지 않다고 판단
    - 바람직한 잔차 분포는 랜덤하게 퍼져 있는 상태
- 오차항의 정규성 진단
    - 시각적인 정규성 검정 방법 : 히스토그램, Q-Q plot
    - 정규성을 만족할 때 데이터의 분포가 직선 안에 모여있다는 것을 확인 가능 -> 정규성 만족
    - 수치적 검정 방법
        
