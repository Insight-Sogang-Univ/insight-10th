# 회귀 이론
*Q1. 회귀, 분류, 군집화를 구분하시오*
*Q2. 선형 회귀*
*Q3. 다중공선성*
*Q4. 최소제곱법*



**0. Intro**
*지도 학습: 정답값(label)이 있는 데이터셋으로 학습하는 방식
(ex)회귀, 분류
*비지도 학습: 정답값(label)이 있는 데이터셋으로 학습하는 방식
(ex)군집화/클러스터링
*강화 학습:
(ex)Model based, Model Free

*Q1. 회귀, 분류, 군집화를 구분하시오*
[회귀: 둘 이상의 변수 간의 관계를 보여주는 통계적 기법
과거의 데이터로 학습(지도학습)
예측 문제 중에서 출력 변수의 값이 연속적인 값인 문제(예시: 집값 예측, 주식 가격 예측 등)일 때 회귀, 회귀분석을 사용한다.

분류: 지도학습이며, 기존에 존재하는 데이터의 관계를 학습하여 새롭게 관측된 데이터에 대한 결과를 스스로 판별하는 과정이다. 범주형 변수에 대해 예측할 때 사용한다(예시: 스팸 메일 분류)

군집화(Clustering): 비지도학습이며, 주어진 데이터들의 특성ㅇ르 고려해 같은 그룹(cluster)을 정의하고 그룹화 하여 그룹의 대표성을 찾아내는 방법이다. 구분하려고 하는 class 에 대한 정보가 없는 상태에서 학습하므로 비지도 학습이다.  ]

**1. 회귀란?**
회귀: 여러 개의 독립 변수와 한 개의 종속 변수 간의 관계를 모델링하는 기반을 통칭/ 무언가를 예측하는데 사용(예시: 연령의 변화에 따른 소득의 변화, 학군과 집값의 관계 분석)

회귀의 변수: 
(1) 체계적 변수: 독립변수+통제변수(타당성 or Random)
(2) 비체계적 변수: 통계오차-정규분포(이상적인 경우)

*Q2. 선형 회귀*
[선형 회귀:
-실제 값과 예측값의 차이(오류의 제곱 값)을 최소화하는 직선형 회귀선을 최적화하는 방식(데이터를 가장 잘 대변하는 최적의 선을 찾는 과정)
-선형회귀 직선은 x와 y의 관계를 요약해서 설명해준다.
-선형회귀에서 x가 하나면 단순선형 회귀, 2개 이상이면 다중선형회귀라고 한다. 

선형회귀분석의 목적:
데이터의 이해, 예측, 인과관계 증명

단순 선형회귀:
-가정: 두 변수는 인과관계가 있고, x에 따라 y값이 변한다.
-f(x)=y
-단순선형회귀분석: y=\beta_1x+\beta_0

다중 선형회귀:
-연속형 종속변수 하나에 독립 변수가 둘 이상 모인 모형이다.
-다중선형회귀분석: y=\beta_0+\beta_1x_1+\beta_2x_2+...w_nx_n
*Q3. 다중공선성*
[다중공선성: 다중선형회귀를 사용할 떄 주의해야할 점이다.
-설명 변수(독립변수)들 간의 선형 종속이 심한 경우를 뜻한다.
-설명 변수들 간 정보의 중첩이 발생함(설명 변수들 간에 높은 상관관계를 갖음)
-확인방법: 
(1)산점도 그래프(Scatter Plot Matrix) 그리기
(2)상관계수 확인
(3)분산팽창계수 확인(VIF; Variance Inflation Factor)(5넘으면 다중공선성 있음)
-대처방법:
(1)변수 제거
(2)변수 변환
(3)규제 선형 모델(릿지, 라쏘,엘라스틱넷)
(4)PCA]]


**2. 회귀 분석 과정**
회귀 분석 과정:

1. 산점도 그리기(시각화 하여 눈으로 확인)

2. 회귀계수 추정:
*Q4. 최소제곱법*
[(1)최소제곱법(최소자승법):
오차를 최소화 시키는 방법으로 회귀 계수(베타 제로, 베타원)을 추정
이상치에 취약하다는 단점이 있음]
(2)오차항 가정 직접법:
오차항의 평균(기댓값)은 0이며, 오차항의 분산은 x에 관계없이 일정하다는 가정을 통해 회귀 모델의 평균과 공분산을 구한다. 이 과정에서 회귀계수가 구해진다. 
(3)이외에도 최대우도법 등이 있음

3. 유의성 검정:모델에서 사용한 독립 변수들이 종속 변수에 대해 유의미한 영향을 미치는 지 검증하는 것
(1) T-test
(2) F-test

*선형회귀분석의 해석방법(SDEM)
S: Significance(유의성 검증) -계수와 변수의 p-value 확인
D: Direction(방향성 확인) -양 음 관계 판단
E: Effect size(효과의 크기) -x가 y에게 유의해도 그 크기가 작으면 의미없음
M: Model Fitting(모델 적합성) -범용성이 적은지?(overfitting 여부) 데이터를 충분히 설명하는지?(underfitting 여부)

4. 회귀 모형의 평가: 선형회귀를 돌린 모델은 어느 정도의 오차를 가지는가?
평균제곱오차(MSE)
결정계수
(이외) 평균제곱근오차, 조작 결정 계수, Akaike정보기준, Schwarz 베이지안 기준, MAPE


**3. 회귀 분석의 기본 가정 진단**
회귀 모형이 적절한가?

1. 선형성 진단
-scatter plot으로 선형 관계 확인(만족하지 않을 시 선형 분석x, 변수 변환 유도)

2. 오차항의 독립성 진단
-시각적: scatter plot으로 오차 앞뒤 간의 관계를 파악
-수치적: Durbin-Watson 검정
0일수록 양의 상관관계
2일수록 자기상관 없어짐(오차범위 0.5)
4일수록 음의 상관관계
*자기 상관관계가 있으면 MSE는 오차분산을 과소추정하여 귀무가설을 기각한다. 따라서 실제로 무의마한 결과를 유의미한 결과로 왜곡도출한다.*
*자기 상관관계가 없으면 독립적으로 가정할 수 있다.*

3.오차항의 등분산성 진단(오차들이 Random 한가?)
n개의 오추항이 모두 같은 분산을 갖는 분포로부터 추출되었는지 확인. 특정 독립변수 구간에서 뚜렷하게 크거나 작으면 등분산 가정에 타당하지 않다고 판단 가능. 

4. 오차항의 정규성 진단(데이터의 분포가 직선 안에 모여있는가?)
-시각적: 히스토그램, Q-Q Plot
-수치적: Shapiro-wilk 검정, Jarque-Bera 검정


